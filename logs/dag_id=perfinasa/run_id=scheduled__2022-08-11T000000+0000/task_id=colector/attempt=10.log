[2022-09-27T21:01:57.445+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: perfinasa.colector scheduled__2022-08-11T00:00:00+00:00 [queued]>
[2022-09-27T21:01:57.454+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: perfinasa.colector scheduled__2022-08-11T00:00:00+00:00 [queued]>
[2022-09-27T21:01:57.454+0000] {taskinstance.py:1362} INFO - 
--------------------------------------------------------------------------------
[2022-09-27T21:01:57.454+0000] {taskinstance.py:1363} INFO - Starting attempt 10 of 10
[2022-09-27T21:01:57.455+0000] {taskinstance.py:1364} INFO - 
--------------------------------------------------------------------------------
[2022-09-27T21:01:57.467+0000] {taskinstance.py:1383} INFO - Executing <Task(PythonOperator): colector> on 2022-08-11 00:00:00+00:00
[2022-09-27T21:01:57.471+0000] {standard_task_runner.py:54} INFO - Started process 361 to run task
[2022-09-27T21:01:57.473+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'perfinasa', 'colector', 'scheduled__2022-08-11T00:00:00+00:00', '--job-id', '313', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpmvbfhzaw']
[2022-09-27T21:01:57.473+0000] {standard_task_runner.py:83} INFO - Job 313: Subtask colector
[2022-09-27T21:01:57.474+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/***/dags/dag.py
[2022-09-27T21:01:57.842+0000] {task_command.py:384} INFO - Running <TaskInstance: perfinasa.colector scheduled__2022-08-11T00:00:00+00:00 [running]> on host 71d781bb930a
[2022-09-27T21:01:57.901+0000] {taskinstance.py:1592} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=perfinasa
AIRFLOW_CTX_TASK_ID=colector
AIRFLOW_CTX_EXECUTION_DATE=2022-08-11T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=10
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-08-11T00:00:00+00:00
[2022-09-27T21:01:57.902+0000] {tasks.py:42} INFO - Defining DEC to export information
[2022-09-27T21:01:57.908+0000] {tasks.py:357} INFO - Reading prep dataframe
[2022-09-27T21:01:57.916+0000] {tasks.py:150} INFO - Instantiating the Browser with the requested settings
[2022-09-27T21:02:00.303+0000] {tasks.py:164} INFO - Browser configured
[2022-09-27T21:02:00.303+0000] {tasks.py:287} INFO - Removing nan URL values
[2022-09-27T21:02:00.304+0000] {tasks.py:288} INFO - Requested prices before: 28
[2022-09-27T21:02:00.306+0000] {tasks.py:293} INFO - Requested prices after: 21
[2022-09-27T21:02:00.306+0000] {distinct.py:20} INFO - /opt/***
[2022-09-27T21:02:00.307+0000] {distinct.py:30} INFO - Add size specifications to dataframe
[2022-09-27T21:02:00.313+0000] {distinct.py:39} INFO - Collecting prices
[2022-09-27T21:02:00.314+0000] {distinct.py:79} INFO - Ignoring size specification
[2022-09-27T21:02:04.769+0000] {distinct.py:86} INFO - Price of 1567833 - BARRADEFERROQUADRADO: R$ 40,63
[2022-09-27T21:02:04.843+0000] {distinct.py:79} INFO - Ignoring size specification
[2022-09-27T21:02:06.979+0000] {distinct.py:86} INFO - Price of 1565052 - BARRATEMFERRO: R$ 123,12
[2022-09-27T21:02:09.039+0000] {distinct.py:95} INFO - Sizes requested: ['3000 x 1200']
[2022-09-27T21:02:09.228+0000] {distinct.py:101} INFO - Selected size: 3000 x 1200 mm (R$ 667,98)
[2022-09-27T21:02:09.491+0000] {distinct.py:108} INFO - Price of 1561987 - CHAPADEACOFINAAQUENTE: 3000 x 1200 mm (R$ 667,98)
[2022-09-27T21:02:11.705+0000] {distinct.py:95} INFO - Sizes requested: ['2000 x 1200']
[2022-09-27T21:02:11.861+0000] {distinct.py:101} INFO - Selected size: 2000 x 1200 mm (R$ 275,30)
[2022-09-27T21:02:12.134+0000] {distinct.py:108} INFO - Price of 1561992 - CHAPADEACOFINAAFRIO: 2000 x 1200 mm (R$ 275,30)
[2022-09-27T21:02:14.130+0000] {distinct.py:95} INFO - Sizes requested: ['3 metros']
[2022-09-27T21:02:14.316+0000] {distinct.py:101} INFO - Selected size: 3 metros (R$ 143,12)
[2022-09-27T21:02:14.592+0000] {distinct.py:108} INFO - Price of 1567836 - TELHAEMACO: 3 metros (R$ 143,12)
[2022-09-27T21:02:17.264+0000] {distinct.py:95} INFO - Sizes requested: ['1,20']
[2022-09-27T21:02:17.397+0000] {distinct.py:101} INFO - Selected size: 1,20 mm (R$ 62,00)
[2022-09-27T21:02:17.664+0000] {distinct.py:108} INFO - Price of 1556746 - TUBOINDUSTRIAL: 1,20 mm (R$ 62,00)
[2022-09-27T21:02:19.496+0000] {distinct.py:95} INFO - Sizes requested: ['2000 x 1200']
[2022-09-27T21:02:19.544+0000] {distinct.py:101} INFO - Selected size: 2000 x 1200 mm (R$ 346,16)
[2022-09-27T21:02:19.804+0000] {distinct.py:108} INFO - Price of 1561991 - CHAPADEACOFINAAQUENTE: 2000 x 1200 mm (R$ 346,16)
[2022-09-27T21:02:19.972+0000] {distinct.py:79} INFO - Ignoring size specification
[2022-09-27T21:02:22.025+0000] {distinct.py:86} INFO - Price of 1556787 - TELHADEFIBERGLASS: R$ 399,00
[2022-09-27T21:02:24.130+0000] {distinct.py:95} INFO - Sizes requested: ['2000 x 1000']
[2022-09-27T21:02:24.257+0000] {distinct.py:101} INFO - Selected size: 2000 x 1000 mm (R$ 367,68)
[2022-09-27T21:02:24.545+0000] {distinct.py:108} INFO - Price of 1567835 - CHAPADEACOFINA: 2000 x 1000 mm (R$ 367,68)
[2022-09-27T21:02:26.176+0000] {distinct.py:95} INFO - Sizes requested: ['1,20']
[2022-09-27T21:02:26.515+0000] {distinct.py:101} INFO - Selected size: 1,20 mm (R$ 76,18)
[2022-09-27T21:02:26.881+0000] {distinct.py:108} INFO - Price of 1556747 - TUBOINDUSTRIAL: 1,20 mm (R$ 76,18)
[2022-09-27T21:02:28.224+0000] {distinct.py:95} INFO - Sizes requested: ['3000 x 1200']
[2022-09-27T21:02:28.542+0000] {distinct.py:101} INFO - Selected size: 3000 x 1200 mm (R$ 1.169,73)
[2022-09-27T21:02:28.844+0000] {distinct.py:108} INFO - Price of 1561989 - CHAPADEACOFINAAQUENTE: 3000 x 1200 mm (R$ 1.169,73)
[2022-09-27T21:02:30.280+0000] {distinct.py:95} INFO - Sizes requested: ['3000 x 1200']
[2022-09-27T21:02:30.520+0000] {distinct.py:101} INFO - Selected size: 3000 x 1200 mm (R$ 844,43)
[2022-09-27T21:02:30.814+0000] {distinct.py:108} INFO - Price of 1561985 - PERFILDECHAPADEACOFINAAQUENTE: 3000 x 1200 mm (R$ 844,43)
[2022-09-27T21:02:32.691+0000] {distinct.py:95} INFO - Sizes requested: ['4']
[2022-09-27T21:02:32.779+0000] {distinct.py:101} INFO - Selected size: 4 metros (R$ 191,00)
[2022-09-27T21:02:33.041+0000] {distinct.py:108} INFO - Price of 1567837 - TELHAEMACO: 4 metros (R$ 191,00)
[2022-09-27T21:02:35.086+0000] {distinct.py:95} INFO - Sizes requested: ['6']
[2022-09-27T21:02:35.158+0000] {distinct.py:101} INFO - Selected size: 6,30 mm (1/4") (R$ 56,37)
[2022-09-27T21:02:35.460+0000] {distinct.py:108} INFO - Price of 1567832 - BARRADEFERROCHATO: 6,30 mm (1/4") (R$ 56,37)
[2022-09-27T21:02:35.589+0000] {distinct.py:79} INFO - Ignoring size specification
[2022-09-27T21:02:37.100+0000] {distinct.py:86} INFO - Price of 1569823 - BARRADEFERROT: R$ 123,12
[2022-09-27T21:02:39.135+0000] {distinct.py:95} INFO - Sizes requested: ['3']
[2022-09-27T21:02:39.392+0000] {distinct.py:101} INFO - Selected size: 3 metros (R$ 143,12)
[2022-09-27T21:02:39.716+0000] {distinct.py:108} INFO - Price of 1556788 - TELHADEACO: 3 metros (R$ 143,12)
[2022-09-27T21:02:41.786+0000] {distinct.py:95} INFO - Sizes requested: ['2,65']
[2022-09-27T21:02:41.929+0000] {distinct.py:101} INFO - Selected size: 2,65 mm (R$ 43,09)
[2022-09-27T21:02:42.197+0000] {distinct.py:108} INFO - Price of 1556789 - CANTONEIRA: 2,65 mm (R$ 43,09)
[2022-09-27T21:02:44.166+0000] {distinct.py:95} INFO - Sizes requested: ['2000 x 1200']
[2022-09-27T21:02:44.271+0000] {distinct.py:101} INFO - Selected size: 2000 x 1200 mm (R$ 385,51)
[2022-09-27T21:02:44.545+0000] {distinct.py:108} INFO - Price of 1561988 - CHAPADEACOFINAAQUENTE: 2000 x 1200 mm (R$ 385,51)
[2022-09-27T21:02:46.858+0000] {distinct.py:95} INFO - Sizes requested: ['3000 x 1200']
[2022-09-27T21:02:47.004+0000] {distinct.py:101} INFO - Selected size: 3000 x 1200 mm (R$ 667,98)
[2022-09-27T21:02:47.317+0000] {distinct.py:108} INFO - Price of 1561986 - CHAPADEACOFINAAQUENTE: 3000 x 1200 mm (R$ 667,98)
[2022-09-27T21:02:47.500+0000] {distinct.py:79} INFO - Ignoring size specification
[2022-09-27T21:02:48.587+0000] {distinct.py:117} INFO - Skipping element errors to: https://www.perfinasa.com.br/chapa-fina-a-frio-espessura-0-9-mm?search=chapaff090
[2022-09-27T21:02:48.588+0000] {distinct.py:118} INFO - Error: Message: Unable to locate element: .box-avista > span
Stacktrace:
WebDriverError@chrome://marionette/content/error.js:175:5
NoSuchElementError@chrome://marionette/content/error.js:387:5
element.find/</<@chrome://marionette/content/element.js:331:16

[2022-09-27T21:02:50.507+0000] {distinct.py:95} INFO - Sizes requested: ['2000 x 1200']
[2022-09-27T21:02:50.652+0000] {distinct.py:101} INFO - Selected size: 2000 x 1200 mm (R$ 562,95)
[2022-09-27T21:02:50.920+0000] {distinct.py:108} INFO - Price of 1567834 - CHAPADEACOFINA: 2000 x 1200 mm (R$ 562,95)
[2022-09-27T21:02:51.118+0000] {distinct.py:51} INFO - Size: 20 urls to 20 prices
[2022-09-27T21:02:51.120+0000] {distinct.py:56} INFO - Cleaning price values using Regex
[2022-09-27T21:02:51.123+0000] {distinct.py:62} INFO - Creating lists
[2022-09-27T21:02:51.124+0000] {tasks.py:414} INFO - Saved screenshots and prices
[2022-09-27T21:02:51.124+0000] {tasks.py:248} INFO - Test not passed
[2022-09-27T21:02:51.124+0000] {tasks.py:250} INFO - Difference of 8 prices
[2022-09-27T21:02:51.126+0000] {tasks.py:271} INFO - Requested prices: 28
[2022-09-27T21:02:51.127+0000] {tasks.py:272} INFO - Scraped prices: 20
[2022-09-27T21:02:51.127+0000] {tasks.py:273} INFO - Day of the scraping: 27/09/2022
[2022-09-27T21:02:51.140+0000] {python.py:177} INFO - Done. Returned value was: None
[2022-09-27T21:02:51.154+0000] {taskinstance.py:1406} INFO - Marking task as SUCCESS. dag_id=perfinasa, task_id=colector, execution_date=20220811T000000, start_date=20220927T210157, end_date=20220927T210251
[2022-09-27T21:02:51.188+0000] {local_task_job.py:164} INFO - Task exited with return code 0
[2022-09-27T21:02:51.214+0000] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
