[2022-10-09T23:22:41.468+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: cemaco.colector scheduled__2022-08-11T00:00:00+00:00 [queued]>
[2022-10-09T23:22:41.478+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: cemaco.colector scheduled__2022-08-11T00:00:00+00:00 [queued]>
[2022-10-09T23:22:41.478+0000] {taskinstance.py:1362} INFO - 
--------------------------------------------------------------------------------
[2022-10-09T23:22:41.479+0000] {taskinstance.py:1363} INFO - Starting attempt 5 of 5
[2022-10-09T23:22:41.479+0000] {taskinstance.py:1364} INFO - 
--------------------------------------------------------------------------------
[2022-10-09T23:22:41.493+0000] {taskinstance.py:1383} INFO - Executing <Task(PythonOperator): colector> on 2022-08-11 00:00:00+00:00
[2022-10-09T23:22:41.498+0000] {standard_task_runner.py:54} INFO - Started process 746 to run task
[2022-10-09T23:22:41.500+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'cemaco', 'colector', 'scheduled__2022-08-11T00:00:00+00:00', '--job-id', '16', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpp9b6hhhe']
[2022-10-09T23:22:41.501+0000] {standard_task_runner.py:83} INFO - Job 16: Subtask colector
[2022-10-09T23:22:41.501+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/***/dags/dag.py
[2022-10-09T23:22:41.797+0000] {task_command.py:384} INFO - Running <TaskInstance: cemaco.colector scheduled__2022-08-11T00:00:00+00:00 [running]> on host 7dcbfa2899a4
[2022-10-09T23:22:41.856+0000] {taskinstance.py:1592} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=cemaco
AIRFLOW_CTX_TASK_ID=colector
AIRFLOW_CTX_EXECUTION_DATE=2022-08-11T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=5
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-08-11T00:00:00+00:00
[2022-10-09T23:22:41.860+0000] {tasks.py:241} INFO - Reading prep dataframe
[2022-10-09T23:22:41.866+0000] {tasks.py:122} INFO - Instantiating the Browser with the requested settings
[2022-10-09T23:22:44.723+0000] {tasks.py:126} INFO - Browser configured
[2022-10-09T23:22:44.724+0000] {tasks.py:181} INFO - Removing nan URL values
[2022-10-09T23:22:44.725+0000] {tasks.py:182} INFO - Requested prices before: 35
[2022-10-09T23:22:44.729+0000] {tasks.py:187} INFO - Requested prices after: 35
[2022-10-09T23:22:48.530+0000] {tasks.py:261} INFO - Price of 91792 - SELANTEELASTICOABASEDEPOLIURETANO: R$ 44,90
[2022-10-09T23:22:48.531+0000] {tasks.py:211} INFO - Printing information
[2022-10-09T23:22:48.531+0000] {tasks.py:199} INFO - Scrolling pages on 1 keys
[2022-10-09T23:22:52.771+0000] {tasks.py:261} INFO - Price of 91792 - JOELHO90DEPVCPARAESGOTO: R$ 1,99
[2022-10-09T23:22:52.772+0000] {tasks.py:211} INFO - Printing information
[2022-10-09T23:22:52.772+0000] {tasks.py:199} INFO - Scrolling pages on 1 keys
[2022-10-09T23:22:56.919+0000] {tasks.py:261} INFO - Price of 91792 - BUCHADEREDUCAO: R$ 2,89
[2022-10-09T23:22:56.920+0000] {tasks.py:211} INFO - Printing information
[2022-10-09T23:22:56.920+0000] {tasks.py:199} INFO - Scrolling pages on 1 keys
[2022-10-09T23:23:01.126+0000] {tasks.py:261} INFO - Price of 91792 - FIODECOBREISOLADOFLEXIVELPARACONDUCAOELETRICA: R$ 259,00
[2022-10-09T23:23:01.127+0000] {tasks.py:211} INFO - Printing information
[2022-10-09T23:23:01.127+0000] {tasks.py:199} INFO - Scrolling pages on 1 keys
[2022-10-09T23:23:05.008+0000] {taskinstance.py:1851} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 175, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 193, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/tasks.py", line 257, in colector
    eval(config["type_element"]), config["element"]
  File "/home/airflow/.local/lib/python3.7/site-packages/selenium/webdriver/remote/webdriver.py", line 857, in find_element
    'value': value})['value']
  File "/home/airflow/.local/lib/python3.7/site-packages/selenium/webdriver/remote/webdriver.py", line 428, in execute
    self.error_handler.check_response(response)
  File "/home/airflow/.local/lib/python3.7/site-packages/selenium/webdriver/remote/errorhandler.py", line 243, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchElementException: Message: Unable to locate element: .price.margint10
Stacktrace:
RemoteError@chrome://remote/content/shared/RemoteError.jsm:12:1
WebDriverError@chrome://remote/content/shared/webdriver/Errors.jsm:192:5
NoSuchElementError@chrome://remote/content/shared/webdriver/Errors.jsm:404:5
element.find/</<@chrome://remote/content/marionette/element.js:291:16

[2022-10-09T23:23:05.027+0000] {taskinstance.py:1406} INFO - Marking task as FAILED. dag_id=cemaco, task_id=colector, execution_date=20220811T000000, start_date=20221009T232241, end_date=20221009T232305
[2022-10-09T23:23:05.045+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 16 for task colector (Message: Unable to locate element: .price.margint10
Stacktrace:
RemoteError@chrome://remote/content/shared/RemoteError.jsm:12:1
WebDriverError@chrome://remote/content/shared/webdriver/Errors.jsm:192:5
NoSuchElementError@chrome://remote/content/shared/webdriver/Errors.jsm:404:5
element.find/</<@chrome://remote/content/marionette/element.js:291:16
; 746)
[2022-10-09T23:23:05.090+0000] {local_task_job.py:164} INFO - Task exited with return code 1
[2022-10-09T23:23:05.105+0000] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
